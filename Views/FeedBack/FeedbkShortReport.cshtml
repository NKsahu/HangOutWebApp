@using HangOut.Models.Feedbk;
@using HangOut.Models.Common;
@{
    List<FeedbkItem> feedbkItems = new List<FeedbkItem>();
    List<FeedbkResponse> feedbkResponses = new List<FeedbkResponse>();
    Layout = null;
    if (Request.QueryString["Fdate"] != null && Request.QueryString["Tdate"] != null)
    {
        var UserInfo = Request.Cookies["UserInfo"];
        int OrgId = int.Parse(UserInfo["OrgId"]);
        DateTime FromDate = DateTime.ParseExact(Request.QueryString["Fdate"], "dd-MM-yyyy", System.Globalization.CultureInfo.InvariantCulture);
        DateTime Todate = DateTime.ParseExact(Request.QueryString["Tdate"], "dd-MM-yyyy", System.Globalization.CultureInfo.InvariantCulture);
        List<Feedbk> feedbks = Feedbk.GetAll(OrgId, FromDate, Todate);
        feedbkItems = FeedbkItem.GetAll(OrgId, FromDate, Todate);
        feedbkResponses = FeedbkResponse.GetAll(OrgId, FromDate, Todate);
        // 0:Star,1: Objective,2:Subjective,3:Like Dislike Ok,4:star-subjective
        var OnlyRatingItems = feedbkItems.FindAll(x => x.ResponseType == 0);
        var GroupItemByRating = OnlyRatingItems.GroupBy(x => x.Rating);
        var SumOfRatingByCID = 0.00;
        var TotalPerson = OnlyRatingItems.Count;
        foreach (var ratings in GroupItemByRating)
        {
            SumOfRatingByCID += ratings.Key * ratings.ToList().Count;
        }
        double TotalItemRating = SumOfRatingByCID / TotalPerson;
        var ResponseByQID = feedbkResponses.GroupBy(x => x.QID);

<style>
 th {
     background-color: deepskyblue;
 }
</style>
        <div class="card-header">
            <h3>User FeedBack</h3>
        </div>
        <div class="card">
            <!--item feedback-->
            @if (TotalPerson > 0)
            {
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Item FeedBack</th>
                        <th>@TotalItemRating.ToString("0.00") / 5 </th>
                        <th>Ratings</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @{ 
                        var GroupByItems = OnlyRatingItems.GroupBy(x => x.ItemID);
                        foreach(var items in GroupByItems)
                        {


                        <tr>
                        <td>Item FeedBack</td>
                        <td>4.1 / 5 </td>
                        <td>Ratings</td>
                        <td></td>
                       </tr>
                        }

                    }
                    
                </tbody>

            </table>
                        }
            

            <!--STAR TYPE-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Rate our Staff Behaviour</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td>Details</td>
                    </tr>
                </tbody>

            </table>


            <!--START & SUBJECTIVE-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>About Staff Behaviour</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td></td>
                        <td>Details</td>
                    </tr>
                </tbody>

            </table>

            <!--SUBJECTIVE-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Rate our Staff Behaviour</th>
                        <th>Details</th>
                    </tr>
                </thead>
            </table>

            <!--LIKE DISLIKE OK-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Rate our Staff Behaviour</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>LIKED 0   DISLIKE 0  NORMAL 0</td>
                        <td>Details</td>
                    </tr>
                </tbody>
            </table>

            <!--MCQ-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Rate our Staff Behaviour</th>
                        <th>Details </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>LIKED 0   DISLIKE 0  NORMAL 0</td>

                    </tr>
                </tbody>
            </table>

            <!--SUGGESTION FEEDBACK-->
            <table class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Rate our Staff Behaviour</th>
                        <th>Details </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>LIKED 0   DISLIKE 0  NORMAL 0</td>

                    </tr>
                </tbody>
            </table>

        </div>

    }
}
<script>
    function ShowDetails() {

    }

</script>
